# DevSecOps Project Secrets - Default Configuration
#
# This file provides sample configurations for project-scoped secrets files
# conforming to schemas/devsecops/secrets/v1.0.0/secrets.schema.json
#
# Used by: fulmen-secrets (fulsecrets) CLI tool, L'Orage Central, Etknow microtool
#
# WARNING: This is a SAMPLE file with anonymized/fake secrets for demonstration.
#          DO NOT commit real secrets to version control in plaintext.
#          Use encryption (fulsecrets encrypt) before committing production secrets.
schema_version: v1.0.0
# Example 1: Development Environment (Plaintext)
# Use case: Local development with non-sensitive test credentials
# Policy: allow_plain_secrets = true (default)

projects:
  - project_slug: myapp-dev
    env_prefix: APP_
    secrets:
      DATABASE_URL: postgres://localhost:5432/myapp_dev
      REDIS_URL: redis://localhost:6379/0
      API_KEY: dev_key_12345_not_real
      SECRET_TOKEN: dev_secret_abc_not_real
      LOG_LEVEL: debug
  - project_slug: myapp-test
    env_prefix: APP_
    secrets:
      DATABASE_URL: postgres://localhost:5432/myapp_test
      REDIS_URL: redis://localhost:6379/1
      API_KEY: test_key_67890_not_real
      SECRET_TOKEN: test_secret_xyz_not_real
      LOG_LEVEL: info
policies:
  allow_plain_secrets: true # OK for development

# Example 2: Multi-Project Configuration (Plaintext)
# Use case: Monorepo with multiple services sharing some secrets
# Pattern: Project slugs identify service + environment
---
schema_version: v1.0.0
projects:
  - project_slug: api-staging
    secrets:
      DATABASE_URL: postgres://staging-db.internal:5432/api
      REDIS_URL: redis://staging-cache.internal:6379
      JWT_SECRET: staging_jwt_secret_abc123_not_real
      API_KEY: sk_staging_api_key_not_real
      SENTRY_DSN: https://fake@sentry.io/staging
  - project_slug: worker-staging
    secrets:
      DATABASE_URL: postgres://staging-db.internal:5432/api # Shared DB
      QUEUE_URL: amqp://staging-queue.internal:5672
      WORKER_TOKEN: staging_worker_token_xyz789_not_real
      SENTRY_DSN: https://fake@sentry.io/staging
  - project_slug: frontend-staging
    env_prefix: VITE_ # Frontend framework convention
    secrets:
      API_URL: https://api-staging.example.com
      ANALYTICS_KEY: staging_analytics_key_not_real
      SENTRY_DSN: https://fake@sentry.io/staging

# Example 3: Production Environment (Encrypted - GPG)
# Use case: Production secrets encrypted with GPG for team access
# Policy: allow_plain_secrets = false (enforce encryption)
#
# How to create:
#   1. Create plaintext file with real secrets
#   2. Run: fulsecrets encrypt secrets.yaml --gpg-key team@example.com
#   3. Commit encrypted file to version control
#
# How to use:
#   fulsecrets exec -p myapp-prod -- npm start
#   (prompts for GPG passphrase, decrypts in memory, runs command)
---
schema_version: v1.0.0
encryption:
  method: gpg
  key_id: 7A8B9C0D1E2F3A4B # GPG key fingerprint
  encrypted_at: "2025-11-15T10:00:00Z"
  cipher: AES-256-GCM
# The 'projects' array is encrypted inside this ciphertext blob
# When decrypted, it contains:
#   projects:
#     - project_slug: myapp-prod
#       secrets:
#         DATABASE_URL: postgres://prod-db.example.com:5432/myapp
#         API_KEY: sk_live_real_production_key
#         ...etc
ciphertext: |
  -----BEGIN PGP MESSAGE-----

  hQIMA3xQvBF2g8NSAQ//ZQWJRW8F... [This is a fake/truncated example]
  ...real encrypted payload would be here...
  -----END PGP MESSAGE-----
policies:
  allow_plain_secrets: false # Enforce encryption for production

# Example 4: Production Environment (Encrypted - age)
# Use case: Modern encryption with age instead of GPG
# Pattern: Same as GPG but using age public/private key pairs
#
# How to create:
#   1. Generate age keypair: age-keygen -o ~/.config/fulsecrets/key.txt
#   2. Store public key in team docs, private key secure
#   3. Run: fulsecrets encrypt secrets.yaml --age-recipient age1ql3z...
#
# How to use:
#   fulsecrets exec -p myapp-prod --age-identity ~/.config/fulsecrets/key.txt -- npm start
---
schema_version: v1.0.0
encryption:
  method: age
  key_id: age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p
  encrypted_at: "2025-11-15T14:30:00-05:00"
  cipher: ChaCha20-Poly1305
ciphertext: |
  YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBE...
  [This is a fake/truncated base64 example]
  ...real encrypted payload would be here...
policies:
  allow_plain_secrets: false

# Example 5: Passphrase-Based Encryption (Simplest)
# Use case: Solo developer or small team with shared passphrase
# Pattern: No key management needed, just a strong passphrase
#
# How to create:
#   fulsecrets encrypt secrets.yaml --passphrase
#   (prompts for passphrase, encrypts symmetrically)
#
# How to use:
#   fulsecrets exec -p myapp-prod --passphrase -- npm start
#   (prompts for passphrase to decrypt)
#
# CI/CD usage:
#   export FULSECRETS_PASSPHRASE="${{ secrets.FULSECRETS_PASSPHRASE }}"
#   fulsecrets exec -p myapp-prod --passphrase -- ./deploy.sh
#   (reads passphrase from env var, no prompt)
---
schema_version: v1.0.0
encryption:
  method: passphrase
  encrypted_at: "2025-11-15T16:00:00Z"
  cipher: AES-256-GCM
  # No key_id for passphrase-based encryption
ciphertext: |
  U2FsdGVkX1+abcd1234... [This is a fake/truncated example]
  ...real encrypted payload would be here...
policies:
  allow_plain_secrets: false

# Best Practices & Security Notes:
#
# 1. NEVER commit plaintext production secrets to version control
#    - Always encrypt production files before git add
#    - Use .gitignore for *-plain.yaml, *-decrypted.yaml patterns
#
# 2. Policy enforcement:
#    - Set allow_plain_secrets: false for staging/production
#    - Keep allow_plain_secrets: true for local development
#    - Use fulsecrets validate --strict to catch violations
#
# 3. Key management:
#    - GPG: Good for teams with existing GPG infrastructure
#    - Age: Modern alternative, simpler key management
#    - Passphrase: Simplest for solo dev, store in password manager
#
# 4. CI/CD integration:
#    - Store passphrases/keys in GitHub Secrets / GitLab CI Variables
#    - Use environment variables (FULSECRETS_PASSPHRASE) to avoid prompts
#    - Never echo/print secrets in CI logs
#
# 5. Secret rotation:
#    - Update secrets in plaintext, re-encrypt with same method
#    - For key rotation: decrypt, re-encrypt with new key
#    - Update encryption.encrypted_at to track rotation
#
# 6. Temporary files:
#    - fulsecrets edit uses secure temp files (/dev/shm, 0600 perms)
#    - Manual workflow: always rm plaintext files after encryption
#    - Use shred/srm for sensitive cleanup if available
#
# 7. Environment variable naming:
#    - Use UPPER_SNAKE_CASE for secret keys
#    - Add env_prefix for namespacing (APP_, SERVICE_, etc.)
#    - Avoid generic names like "KEY" or "TOKEN" (use API_KEY, JWT_TOKEN)
#
# 8. Compliance / FIPS mode:
#    - Set allow_plain_secrets: false for compliance
#    - Use GPG with FIPS 140-2 validated crypto if required
#    - Document encryption method in security policy
#
# Schema Documentation:
#   https://github.com/fulmenhq/crucible/blob/main/docs/standards/devsecops/project-secrets.md
#
# CLI Tool (fulmen-secrets / fulsecrets):
#   https://github.com/fulmenhq/fulmen-secrets
---
